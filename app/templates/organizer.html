{% extends 'organizer_layout/base.html' %} {% block content %}
<link
  rel="stylesheet"
  href="{{ url_for('static', filename='css/organizer.css') }}"
/>
<div class="container mt-4">
  <!-- Th√¥ng tin s·ª± ki·ªán -->
  <h5 class="text-success fw-bold">Th√¥ng tin s·ª± ki·ªán</h5>

  <div class="form-container d-flex p-3 mt-3">
    <!-- Khung t·∫£i ·∫£nh s·ª± ki·ªán -->
    <div class="upload-box me-4">
      <label for="eventImage" class="upload-label">
        <span>üì∑<br />T·∫£i h√¨nh ·∫£nh s·ª± ki·ªán</span>
        <input type="file" id="eventImage" hidden />
      </label>
    </div>

    <!-- Form s·ª± ki·ªán -->
    <form
      method="POST"
      action="{{ url_for('create_event_form') }}"
      class="flex-grow-1"
    >
      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white">T√™n s·ª± ki·ªán</label>
        <div class="col-sm-9">
          <input
            type="text"
            name="event_name"
            class="form-control dark-input"
            required
          />
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white">T·ªânh/Th√†nh</label>
        <div class="col-sm-9">
          <select
            name="city_id"
            id="citySelect"
            class="form-control dark-input"
            required
          >
            <option value="">-- Ch·ªçn T·ªânh/Th√†nh --</option>
            {% for city in cities %}
            <option value="{{ city.id }}">{{ city.name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white">Qu·∫≠n/Huy·ªán</label>
        <div class="col-sm-9">
          <select
            name="district_id"
            id="districtSelect"
            class="form-control dark-input"
            required
          >
            <option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>
          </select>
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white"
          >S·ªë nh√†, t√™n ƒë∆∞·ªùng</label
        >
        <div class="col-sm-9">
          <input
            type="text"
            name="address"
            class="form-control dark-input"
            required
          />
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white">Th·ªÉ lo·∫°i</label>
        <div class="col-sm-9">
          <select name="event_type_id" class="form-select dark-input" required>
            <option value="">--Ch·ªçn lo·∫°i s·ª± ki·ªán--</option>
            {% for event_type in event_types %}
            <option value="{{ event_type.id }}">{{ event_type.name }}</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white">Ng√†y di·ªÖn ra</label>
        <div class="col-sm-9">
          <input
            type="date"
            name="event_date"
            class="form-control dark-input"
            required
          />
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white">Th·ªùi gian</label>
        <div class="col-sm-9">
          <input
            type="time"
            name="event_time"
            class="form-control dark-input"
            required
          />
        </div>
      </div>

      <div class="mb-3 row">
        <label class="col-sm-3 col-form-label text-white">M√¥ t·∫£ s·ª± ki·ªán:</label>
        <div class="col-sm-9">
          <textarea
            name="description"
            rows="3"
            class="form-control dark-input"
          ></textarea>
        </div>
      </div>

      <div class="text-end">
        <button type="submit" class="btn btn-success px-4">T·∫°o s·ª± ki·ªán</button>
      </div>
    </form>
  </div>
</div>

<script>
  document.getElementById("citySelect").addEventListener("change", function () {
    const cityId = this.value;
    const districtSelect = document.getElementById("districtSelect");

    // X√≥a c√°c option c≈©
    districtSelect.innerHTML =
      '<option value="">-- Ch·ªçn Qu·∫≠n/Huy·ªán --</option>';

    if (cityId) {
      // G·ªçi API ƒë·ªÉ l·∫•y danh s√°ch qu·∫≠n/huy·ªán
      fetch(`/api/districts/${cityId}`)
        .then((response) => response.json())
        .then((districts) => {
          districts.forEach((district) => {
            const option = document.createElement("option");
            option.value = district.id;
            option.textContent = district.name;
            districtSelect.appendChild(option);
          });
        })
        .catch((error) => {
          console.error("Error fetching districts:", error);
        });
    }
  });
</script>
{% endblock %}
